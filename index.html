<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Modulo</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
    <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.js"></script>
    <script src="https://unpkg.com/downloadjs"></script>
    <script src="https://unpkg.com/@pdf-lib/fontkit"></script>
</head>

<body>
    <div class="wp-block-column" style="flex-basis:100%"> <!-- NAV -->
        <ul class="has-text-color" style="color:#46658b"> <!-- LIST -->
            <!--------------------------------------------------------->
            <li class="list_item list_item--click">
                <div class="list_button list_button--click">
                    <a class="nav_link">Formato de No Adeudo</a>
                    <img src="css elements/bx-chevron-right.svg" class="list_arrow">
                </div>
                <ul class="list_show">
                    <li class="list_inside">
                        Numero de control: <input type="text" id="noControl" style="width: 150;">
                    </li>
                    <li class="list_inside">
                        Nombre: <input type="text" id="nombre" style="width: 219;">
                    </li>
                    <li class="list_inside">
                        Apellido paterno: <input type="text" id="apellidoPat" style="width: 163;">
                    </li>
                    <li class="list_inside">
                        Apellido Materno: <input type="text" id="apellidoMat" style="width: 157;">
                    </li>
                    <li class="list_inside">
                        Semestre: <input type="text" id="semestre" style="width: 20;">
                    </li>
                    <li class="list_inside">
                        Carrera:<br>
                        <input type="radio" name="carrera" id="materiales" value="Ingenieria en Materiales">
                        <label for="materiales">Ingeniería en Materiales</label><br>
                        <input type="radio" name="carrera" id="mecatronica" value="Ingenieria en Mecatronica">
                        <label for="mecatronica">Ingeniería en Mecatronica</label><br>
                        <input type="radio" name="carrera" id="sistemas" value="Ingenieria en Sistemas Computacionales">
                        <label for="sistemas">Ingeniería en Sistemas Computacionales</label><br>
                        <input type="radio" name="carrera" id="industrial" value="Ingenieria Industrial">
                        <label for="industrial">Ingeniería Industrial</label><br>
                        <input type="radio" name="carrera" id="mecanica" value="Ingenieria Mecanica">
                        <label for="mecanica">Ingeniería Mecánica</label><br>
                        <input type="radio" name="carrera" id="electrica" value="Ingenieria en Electrica">
                        <label for="electrica">Ingeniería en Electrica</label><br>
                        <input type="radio" name="carrera" id="electronica" value="Ingenieria en Electronica">
                        <label for="electronica">Ingeniería en Electronica</label><br>
                        <input type="radio" name="carrera" id="gestion" value="Ingenieria en Gestion Empresarial">
                        <label for="gestion">Ingeniería en Gestion Empresarial</label><br>
                        <input type="radio" name="carrera" id="logistica" value="Ingenieria en Logistica">
                        <label for="logistica">Ingeniería en Logistica</label><br>
                        <input type="radio" name="carrera" id="arquitectura" value="Arquitectura">
                        <label for="arquitectura">Arquitectura</label><br>
                        <br>
                    </li>
                    <li class="list_inside">
                        Laboratorio de NO Adeudo: <br>
                        <input type="radio" name="laboratorio" id="sistemas" value="Laboratorio de Redes">
                        <label for="sistemas">Laboratorio de Redes</label><br>
                        <input type="radio" name="laboratorio" id="electrica" value="Laboratorio de Electrica">
                        <label for="sistemas">Laboratorio de Electrica</label><br>
                        <input type="radio" name="laboratorio" id="electronica" value="Laboratorio de Electronica">
                        <label for="sistemas">Laboratorio de Electronica</label><br>
                        <input type="radio" name="laboratorio" id="materiales" value="Laboratorio de Materiales">
                        <label for="sistemas">Laboratorio de Materiales</label><br>

                    </li>

                    <button type="submit" class="list_inside" onclick="Formato_noadeudo()">Generar PDF</button>
                </ul>
            </li>
            <li class="list_item">
                <div class="list_button">
                    <a class="nav_link">Formato de Requisitos para Carta de Presentación a Empresa</a>
                    <img src="css elements/bx-chevron-right.svg" class="list_arrow">
                </div>
                <!-- Aqui va ul-->
            </li>
            <li class="list_item">
                <div class="list_button">
                    <a class="nav_link">Solicitud a Comité Académico</a>
                    <img src="css elements/bx-chevron-right.svg" class="list_arrow">
                </div>
                <!-- Aqui va ul-->
            </li>
            <li class="list_item">
                <div class="list_button">
                    <a class="nav_link">Solicitud del estudiante para la Acreditación de Residencia Profesional</a>
                    <img src="css elements/bx-chevron-right.svg" class="list_arrow">
                </div>
                <!-- Aqui va ul-->
            </li>
            <li class="list_item">
                <div class="list_button">
                    <a class="nav_link">Solicitud de Curso Ordinario Semipresencial</a>
                    <img src="css elements/bx-chevron-right.svg" class="list_arrow">
                </div>
                <!-- Aqui va ul-->
            </li>
            <li class="list_item">
                <div class="list_button">
                    <a class="nav_link">Solicitud de Análisis de Convalidación</a>
                    <img src="css elements/bx-chevron-right.svg" class="list_arrow">
                </div>
                <!-- Aqui va ul-->
            </li>
            <li class="list_item">
                <div class="list_button">
                    <a class="nav_link">Solicitud de Baja Temporal y Definitiva</a>
                    <img src="css elements/bx-chevron-right.svg" class="list_arrow">
                </div>
                <!-- Aqui va ul-->
            </li>
            <li class="list_item">
                <div class="list_button">
                    <a class="nav_link">Solicitud de Participación en el Programa de Movilidad Estudiantil</a>
                    <img src="css elements/bx-chevron-right.svg" class="list_arrow">
                </div>
                <!-- Aqui va ul-->
            </li>
            <li class="list_item">
                <div class="list_button">
                    <a class="nav_link">Solicitud de Resolución de Equivalencia de Estudios</a>
                    <img src="css elements/bx-chevron-right.svg" class="list_arrow">
                </div>
                <!-- Aqui va ul-->
            </li>
            <li class="list_item">
                <div class="list_button">
                    <a class="nav_link">Solicitud de Traslado</a>
                    <img src="css elements/bx-chevron-right.svg" class="list_arrow">
                </div>
                <!-- Aqui va ul-->
            </li>
            <!-------------------------------------------------------->
        </ul>
    </div>
    <!------------------------------------------- Scripts ---------------------------------------------->
    <script>
        let lisElements = document.querySelectorAll('.list_button--click');
        lisElements.forEach(lisElement => {
            lisElement.addEventListener('click', () => {
                lisElement.classList.toggle('arrow')

                let height = 0;
                let menu = lisElement.nextElementSibling;
                if (menu.clientHeight == "0") {
                    height = menu.scrollHeight;
                }

                menu.style.height = height + "px";
            })
        });
    </script>
    <script>
        const { PDFDocument, TextAlignment } = PDFLib

        async function Formato_noadeudo() {
            /* Variables */
            const date = new Date();
            var vdia = date.getDate().toString(); 
            var nmes = date.getMonth();
            var vmes = ["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"];
            var vanio = date.getFullYear().toString();
            var vnoControl = document.getElementById("noControl").value;
            var vnombre = document.getElementById("nombre").value;
            var vapellidoPat = document.getElementById("apellidoPat").value;
            var vapellidoMat = document.getElementById("apellidoMat").value;
            var vsemestre = document.getElementById("semestre").value;
            var vcarrera = document.querySelector('input[name="carrera"]:checked').value;
            var vlaboratorio = document.querySelector('input[name="laboratorio"]:checked').value;

            /* Import Fonts */
            const MontserratURL = "./fonts/Montserrat/static/Montserrat-Regular.ttf";
            const MontserratBoldURL = "./fonts/Montserrat/static/Montserrat-BoldItalic.ttf";
            const Montserrat = await fetch(MontserratURL).then(res => res.arrayBuffer())
            const MontserratBold = await fetch(MontserratBoldURL).then(res => res.arrayBuffer())
            /* Import template */
            const template = "./pdf/Formato.pdf";
            const formPdfBytes = await fetch(template).then(res => res.arrayBuffer())

            const pdfDoc = await PDFDocument.load(formPdfBytes);
            pdfDoc.registerFontkit(fontkit);

            const pages = pdfDoc.getPages();
            const page = pages[0];

            const form = pdfDoc.getForm(); //Se define tipo form

            var Font = await pdfDoc.embedFont(Montserrat);

            page.drawText("División de Estudios Profesionales", {
                x: 177,
                y: 663.5,
                size: 16,
                font: Font,
            });
            page.drawText("Constancia de NO Adeudo", {
                x: 204,
                y: 644,
                size: 16,
                font: Font,
            });

            /* Lugar y fecha */
            const yfecha = 614.7;
            page.drawText("Querétaro, Qro.,    a", {
                x: 269.3,
                y: yfecha,
                size: 10,
                font: Font,
            });
            const dia = form.createTextField("dia"); //Se crea el txtField de dia
            dia.setText(vdia);
            dia.setAlignment(TextAlignment.Center);
            dia.addToPage(page, {
                x: 370,
                y: 608,
                width: 20,
                height: 20,
                borderWidth: 0,
            });
            dia.setFontSize(10);
            dia.enableReadOnly();
            page.drawText("de", {
                x: 397,
                y: yfecha,
                size: 10,
                font: Font,
            });
            const mes = form.createTextField("mes"); //Se crea el txtField de mes
            mes.setText(vmes[nmes]);
            mes.setAlignment(TextAlignment.Center);
            mes.addToPage(page, {
                x: 413,
                y: 608,
                width: 84,
                height: 20,
                borderWidth: 0,
            });
            mes.setFontSize(10);
            mes.enableReadOnly();
            page.drawText("de", {
                x: 499.5,
                y: yfecha,
                size: 10,
                font: Font,
            });
            const anio = form.createTextField("anio"); //Se crea el txtField de año
            anio.setText(vanio);
            anio.setAlignment(TextAlignment.Center);
            anio.addToPage(page, {
                x: 518,
                y: 607.5,
                width: 37,
                height: 20,
                borderWidth: 0,
            });
            anio.setFontSize(10);
            anio.enableReadOnly();

            page.drawText("Por medio de la presente, hacemos constar que el alumno:", {
                x: 163.5,
                y: 587.1,
                size: 10,
                font: Font,
            });

            /* Tabla */
            page.drawRectangle({
                x: 61,
                y: 520,
                width: 530,
                height: 50,
                borderWidth: 1,
                opacity: 0,
            });
            /* No. control */
            page.drawRectangle({
                x: 64,
                y: 547.5,
                width: 67,
                height: 19.7,
                borderWidth: 1,
                opacity: 0,
            });
            page.drawText("No. Control", {
                x: 66.6,
                y: 553.4,
                size: 10,
                font: Font,
            });
            const noControl = form.createTextField("noControl"); //Se crea el txtField de numero de control
            noControl.setText(vnoControl);
            noControl.setAlignment(TextAlignment.Center);
            noControl.addToPage(page, {
                x: 133.9,
                y: 547.5,
                width: 67,
                height: 19.7,
            });
            noControl.setFontSize(10);
            noControl.enableReadOnly();

            /* Nombre */
            page.drawRectangle({
                x: 205,
                y: 547.5,
                width: 60,
                height: 19.7,
                borderWidth: 1,
                opacity: 0,
            });
            page.drawText("Nombre", {
                x: 211.5,
                y: 553.4,
                size: 10,
                font: Font,
            });
            const nombre = form.createTextField("nombre"); //Se crea el txtField de nombre
            nombre.setText(vnombre + " " + vapellidoPat + " " + vapellidoMat);
            nombre.setAlignment(TextAlignment.Center);
            nombre.addToPage(page, {
                x: 268.5,
                y: 547.5,
                width: 320,
                height: 19.7,
            });
            nombre.setFontSize(10);
            nombre.enableReadOnly();

            /* Semestre */
            page.drawRectangle({
                x: 64,
                y: 523.5,
                width: 67,
                height: 21,
                borderWidth: 1,
                opacity: 0,
            });
            page.drawText("Semestre", {
                x: 70.6,
                y: 530,
                size: 10,
                font: Font,
            });
            const semestre = form.createTextField("semestre"); //Se crea el txtField de semestre
            semestre.setText(vsemestre);
            semestre.setAlignment(TextAlignment.Center);
            semestre.addToPage(page, {
                x: 133.9,
                y: 523.5,
                width: 39,
                height: 21,
            });
            semestre.setFontSize(10);
            semestre.enableReadOnly();

            /* Carrera */
            page.drawRectangle({
                x: 176,
                y: 523.5,
                width: 89,
                height: 21,
                borderWidth: 1,
                opacity: 0,
            });
            page.drawText("Carrera", {
                x: 200,
                y: 530,
                size: 10,
                font: Font,
            });
            const carrera = form.createTextField("carrera"); //Se crea el txtField de carrera
            carrera.setText(vcarrera);
            carrera.setAlignment(TextAlignment.Center);
            carrera.addToPage(page, {
                x: 268.5,
                y: 523.5,
                width: 320,
                height: 21,
            });
            carrera.setFontSize(10);
            carrera.enableReadOnly();


            form.updateFieldAppearances(Font);

            page.drawText(
                "No tiene adeudos de material, equipo, herramientas y/o documentos en las áreas indicadas",
                {
                    x: 82.2,
                    y: 495.3,
                    font: Font,
                    size: 10,
                }
            );

            /* Tabla */
            page.drawRectangle({
                x: 54,
                y: 329,
                width: 519,
                height: 150,
                borderWidth: 1,
                opacity: 0,
            });
            /* Cuadros dptos */
            Font = await pdfDoc.embedFont(MontserratBold);
            var txtY = 465.2;
            var recY = 463;
            var recW = 169;
            var recH = 12;
            page.drawRectangle({
                x: 56,
                y: recY,
                width: recW,
                height: recH,
                borderWidth: 1,
                opacity: 0,
            });
            page.drawText("Centro de Información", {
                x: 78.5,
                y: txtY,
                font: Font,
                size: 10,
            });
            page.drawRectangle({
                x: 228,
                y: recY,
                width: recW,
                height: recH,
                borderWidth: 1,
                opacity: 0,
            });
            page.drawText("Laboratorio de Cómputo", {
                x: 245.5,
                y: txtY,
                font: Font,
                size: 10,
            });
            page.drawRectangle({
                x: 401,
                y: recY,
                width: recW,
                height: recH,
                borderWidth: 1,
                opacity: 0,
            });
            page.drawText("Servicios Escolares", {
                x: 433.5,
                y: txtY,
                font: Font,
                size: 10,
            });

            recY = 348;
            recH = 111.5;
            /* Cuadros firmas */
            page.drawRectangle({
                x: 56,
                y: recY,
                width: recW,
                height: recH,
                borderWidth: 1,
                opacity: 0,
            });
            page.drawRectangle({
                x: 228,
                y: recY,
                width: recW,
                height: recH,
                borderWidth: 1,
                opacity: 0,
            });
            page.drawRectangle({
                x: 401,
                y: recY,
                width: recW,
                height: recH,
                borderWidth: 1,
                opacity: 0,
            });

            /* Firma Sello */
            Font = await pdfDoc.embedFont(Montserrat);
            recY = 332;
            recH = 12;
            txtY = 334.5;
            page.drawRectangle({
                x: 56,
                y: recY,
                width: recW,
                height: recH,
                borderWidth: 1,
                opacity: 0,
            });
            page.drawText("Nombre Firma y sello", {
                x: 84.5,
                y: txtY,
                font: Font,
                size: 10,
            });
            page.drawRectangle({
                x: 228,
                y: recY,
                width: recW,
                height: recH,
                borderWidth: 1,
                opacity: 0,
            });
            page.drawText("Nombre Firma y sello", {
                x: 257,
                y: txtY,
                font: Font,
                size: 10,
            });
            page.drawRectangle({
                x: 401,
                y: recY,
                width: recW,
                height: recH,
                borderWidth: 1,
                opacity: 0,
            });
            page.drawText("Nombre Firma y sello", {
                x: 429.7,
                y: txtY,
                font: Font,
                size: 10,
            });


            /* Tabla */
            page.drawRectangle({
                x: 134,
                y: 148,
                width: 358.5,
                height: 155,
                borderWidth: 1,
                opacity: 0,
            });

            /* Cuadros dptos */
            Font = await pdfDoc.embedFont(MontserratBold);
            recY = 282;
            recH = 18;
            txtY = 287.1;
            recW = 182;
            const lab = form.createTextField("lab"); //Se crea el txtField de laboratorio
            lab.setText(vlaboratorio);
            lab.setAlignment(TextAlignment.Center);
            lab.addToPage(page, {
                x: 136,
                y: recY,
                width: recW,
                height: recH,
            });
            lab.setFontSize(10);
            lab.enableReadOnly();
            form.updateFieldAppearances(await pdfDoc.embedFont(MontserratBold));
            recW = 169;
            page.drawRectangle({
                x: 321,
                y: recY,
                width: recW,
                height: recH,
                borderWidth: 1,
                opacity: 0,
            });
            page.drawText("Recursos Financieros", {
                x: 347,
                y: txtY,
                font: Font,
                size: 10,
            });

            /* Cuadros firmas */
            recY = 167;
            recW = 182;
            recH = 111.5;
            page.drawRectangle({
                x: 136,
                y: recY,
                width: recW,
                height: recH,
                borderWidth: 1,
                opacity: 0,
            });
            recW = 169;
            page.drawRectangle({
                x: 321,
                y: recY,
                width: recW,
                height: recH,
                borderWidth: 1,
                opacity: 0,
            });

            /* Firma y sello */
            Font = await pdfDoc.embedFont(Montserrat);
            recY = 151;
            recW = 182;
            recH = 12;
            txtY = 153.5;
            page.drawRectangle({
                x: 136,
                y: recY,
                width: recW,
                height: recH,
                borderWidth: 1,
                opacity: 0,
            });
            page.drawText("Nombre Firma y sello", {
                x: 171,
                y: txtY,
                font: Font,
                size: 10,
            });
            recW = 169;
            page.drawRectangle({
                x: 321,
                y: recY,
                width: recW,
                height: recH,
                borderWidth: 1,
                opacity: 0,
            });
            page.drawText("Nombre Firma y sello", {
                x: 349.4,
                y: txtY,
                font: Font,
                size: 10,
            });

            const pdfBytes = await pdfDoc.save();
            download(pdfBytes, "Formato de No Adeudo.pdf", "application/pdf");
        }
    
    </script>
    <!-------------------------------------------------------------------------------------------------->
</body>

</html>